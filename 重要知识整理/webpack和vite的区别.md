# webpack vs vite

## 热更新原理对比

### webpack的热更新原理

- 通过**webpack-dev-server**创建两个服务器：**提供静态资源的服务（express）**和**Socket服务**
- express server 负责直接提供**静态资源的服务**（打包后的资源直接被浏览器请求和解析）
- socket server 是一个 **websocket 的长连接**，双方可以通信
- 当 **socket server 监听**到对应的模块发生变化时，会生成两个文件`.json（manifest文件）`和`.js文件（update chunk）`
- 通过长连接，socket server 可以直接将这两个文件主动发送给`客户端（浏览器）`
- 浏览器拿到两个新的文件后，通过**HMR runtime机制**，加载这两个文件，并且针对修改的模块进行更新

### vite 热更新

在热模块HMR方面，当修改一个模块的时候，仅需让浏览器重新请求该模块即可，无须像webpack那样需要把该模块的相关依赖模块全部编译一次，效率更高

## 组成

### vite组成

主要由两部分组成：

- 一个开发服务器，它基于 `原生 ES 模块` 提供了丰富的内建功能，如速度快到惊人的模块热更新HMR
- 一套构建指令，它使用 Rollup打包你的代码，并且它是预配置的，可以输出用于生产环境的优化过的静态资源
